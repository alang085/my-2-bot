# bot3 - Telegram Bot 订单管理系统（重组版）

**项目状态**: 🔄 重组中

---

## ⚠️ 重要原则

本项目严格遵循两个核心原则，必须时时遵守：

1. **代码风格指南（绝对不超过界限）**
   - 行长度：最大100字符
   - 文件：不超过500行
   - 函数：不超过50行

2. **业务板块详细规划（一个位置一个坑）**
   - 严格分层架构
   - 每个功能只有一个实现位置
   - 修改时必须删除无效代码

---

## 📋 项目结构

```
bot3/
├── main.py                    # 应用入口
├── config.py                  # 配置管理
├── constants.py               # 常量定义
├── decorators.py              # 装饰器
├── conftest.py                # pytest配置
├── init_db.py                 # 数据库初始化
├── db_operations.py            # 统一数据操作入口（向后兼容层）
│
├── handlers/                  # 表现层：命令处理器
│   ├── module1_user/          # 板块1：用户权限管理
│   ├── module2_finance/       # 板块2：财务管理
│   ├── module3_order/         # 板块3：订单管理
│   ├── module4_automation/    # 板块4：自动化任务
│   ├── module5_data/          # 板块5：数据管理
│   └── module6_credit/        # 板块6：客户信用系统（从bot2导入）
│
├── callbacks/                 # 表现层：回调处理器
├── services/                  # 业务逻辑层
├── db/                        # 数据访问层
├── utils/                     # 工具层
├── tests/                     # 测试文件
└── docs/                      # 文档目录
```

---

## 📊 六个业务板块

1. **板块1：用户权限管理** - 员工管理、归属管理、用户归属映射
2. **板块2：财务管理** - 收入明细、支出明细、资金调整、支付账户管理
3. **板块3：订单管理** - 订单基础操作、状态管理、金额操作
4. **板块4：自动化任务** - 订单搜索、付款提醒、定时播报、群组消息、消息处理
5. **板块5：数据管理** - 财务报表、归属报表、订单总表、每日数据变化、导入导出、撤销还原、诊断修复、操作记录、数据修正、星期分组、工具函数
6. **板块6：客户信用系统** - 从bot2导入

---

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 配置环境变量

创建 `user_config.py` 文件或设置环境变量：

```python
BOT_TOKEN = "your_bot_token"
ADMIN_USER_IDS = "123456789,987654321"
```

### 3. 初始化数据库

数据库会在首次运行时自动初始化。

### 4. 运行机器人

```bash
python main.py
```

---

## 📚 文档

详细的项目结构说明请查看计划文档。

---

**最后更新**: 2025-01-28

