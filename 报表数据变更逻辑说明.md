# æŠ¥è¡¨æ•°æ®å˜æ›´é€»è¾‘è¯´æ˜

## ğŸ“Š æ•°æ®å±‚çº§ç»“æ„

æŠ¥è¡¨æ•°æ®åˆ†ä¸ºä¸‰ä¸ªå±‚çº§ï¼š

1. **å…¨å±€æ•°æ®** (`financial_data` è¡¨) - ç´¯è®¡ç»Ÿè®¡æ•°æ®
2. **åˆ†ç»„æ•°æ®** (`grouped_data` è¡¨) - æŒ‰å½’å±IDåˆ†ç»„çš„ç´¯è®¡ç»Ÿè®¡
3. **æ—¥ç»“æ•°æ®** (`daily_data` è¡¨) - æŒ‰æ—¥æœŸå’Œå½’å±IDçš„æµé‡æ•°æ®

---

## ğŸ”„ æ ¸å¿ƒæ›´æ–°å‡½æ•°

### 1. `update_all_stats(field, amount, count, group_id)`

**åŠŸèƒ½**ï¼šç»Ÿä¸€æ›´æ–°æ‰€æœ‰ç»Ÿè®¡æ•°æ®ï¼ˆå…¨å±€ã€æ—¥ç»“ã€åˆ†ç»„ï¼‰

**æ›´æ–°å±‚çº§**ï¼š
- âœ… å…¨å±€è´¢åŠ¡æ•°æ® (`financial_data`)
- âœ… æ—¥ç»“æ•°æ® (`daily_data`) - ä»…å…è®¸çš„å­—æ®µ
- âœ… åˆ†ç»„æ•°æ® (`grouped_data`) - å¦‚æœæä¾›äº† `group_id`

**å­—æ®µæ˜ å°„è§„åˆ™**ï¼š
- é‡‘é¢å­—æ®µï¼š`field` â†’ `{field}_amount`ï¼ˆç‰¹æ®Šï¼š`interest`, `liquid_funds` ä¿æŒåŸæ ·ï¼‰
- æ•°é‡å­—æ®µï¼š`field` â†’ `{field}_orders`ï¼ˆç‰¹æ®Šï¼š`new_clients`, `old_clients` ä¿æŒåŸæ ·ï¼‰

**æ—¥ç»“å­—æ®µé™åˆ¶**ï¼š
- åªæ›´æ–°å…è®¸çš„å­—æ®µï¼ˆ`DAILY_ALLOWED_PREFIXES`ï¼‰ï¼š
  - `new_clients`, `old_clients`
  - `interest`, `completed`, `breach`, `breach_end`
- **ä¸æ›´æ–°**ï¼š`valid`ï¼ˆå­˜é‡æ•°æ®ï¼Œä¸åœ¨æ—¥ç»“è¡¨ä¸­ï¼‰

**ä½ç½®**ï¼š`utils/stats_helpers.py`

---

### 2. `update_liquid_capital(amount)`

**åŠŸèƒ½**ï¼šæ›´æ–°æµåŠ¨èµ„é‡‘ï¼ˆå…¨å±€ä½™é¢ + æ—¥ç»“æµé‡ï¼‰

**æ›´æ–°å†…å®¹**ï¼š
1. å…¨å±€ä½™é¢ (`financial_data.liquid_funds`)
2. æ—¥ç»“æµé‡ (`daily_data.liquid_flow`)

**ä½ç½®**ï¼š`utils/stats_helpers.py`

---

## ğŸ“ æ•°æ®å˜æ›´åœºæ™¯

### åœºæ™¯1: åˆ›å»ºè®¢å•

**è§¦å‘ä½ç½®**ï¼š`utils/order_helpers.py::try_create_order_from_title()`

**æ›´æ–°é€»è¾‘**ï¼š

```python
# 1. æ ¹æ®åˆå§‹çŠ¶æ€æ›´æ–°è®¢å•ç»Ÿè®¡
if initial_state == 'breach':
    await update_all_stats('breach', amount, 1, group_id)
else:
    await update_all_stats('valid', amount, 1, group_id)

# 2. éå†å²è®¢å•æ‰æ‰£æ¬¾å’Œæ›´æ–°å®¢æˆ·ç»Ÿè®¡
if not is_historical:
    # æ‰£é™¤æµåŠ¨èµ„é‡‘
    await update_liquid_capital(-amount)
    
    # å®¢æˆ·ç»Ÿè®¡
    client_field = 'new_clients' if customer == 'A' else 'old_clients'
    await update_all_stats(client_field, amount, 1, group_id)
```

**å½±å“çš„æ•°æ®**ï¼š
- âœ… `valid_orders` / `valid_amount` æˆ– `breach_orders` / `breach_amount`ï¼ˆå…¨å±€+åˆ†ç»„ï¼‰
- âœ… `liquid_funds`ï¼ˆå…¨å±€ä½™é¢å‡å°‘ï¼‰
- âœ… `liquid_flow`ï¼ˆæ—¥ç»“æµé‡å‡å°‘ï¼‰
- âœ… `new_clients` / `old_clients`ï¼ˆå…¨å±€+åˆ†ç»„+æ—¥ç»“ï¼‰

**æ³¨æ„**ï¼š
- å†å²è®¢å•ä¸æ‰£æ¬¾ï¼Œä¸æ›´æ–°å®¢æˆ·ç»Ÿè®¡
- `valid` æ˜¯å­˜é‡æ•°æ®ï¼Œä¸æ›´æ–°åˆ°æ—¥ç»“è¡¨

---

### åœºæ™¯2: è®¢å•çŠ¶æ€å˜æ›´

#### 2.1 Normal â†” Overdue

**è§¦å‘ä½ç½®**ï¼š`handlers/order_handlers.py::set_normal()`, `set_overdue()`

**æ›´æ–°é€»è¾‘**ï¼š
- ä»…æ›´æ–°è®¢å•çŠ¶æ€
- **ä¸æ›´æ–°ç»Ÿè®¡æ•°æ®**ï¼ˆéƒ½åœ¨ `valid` æ± ä¸­ï¼‰

---

#### 2.2 Normal/Overdue â†’ Breach

**è§¦å‘ä½ç½®**ï¼š
- `handlers/order_handlers.py::set_breach()`
- `utils/order_helpers.py::update_order_state_from_title()`ï¼ˆè‡ªåŠ¨ï¼‰

**æ›´æ–°é€»è¾‘**ï¼š

```python
# 1. æœ‰æ•ˆè®¢å•å‡å°‘
await update_all_stats('valid', -amount, -1, group_id)

# 2. è¿çº¦è®¢å•å¢åŠ 
await update_all_stats('breach', amount, 1, group_id)
```

**å½±å“çš„æ•°æ®**ï¼š
- âœ… `valid_orders` / `valid_amount`ï¼ˆå…¨å±€+åˆ†ç»„ï¼Œå‡å°‘ï¼‰
- âœ… `breach_orders` / `breach_amount`ï¼ˆå…¨å±€+åˆ†ç»„+æ—¥ç»“ï¼Œå¢åŠ ï¼‰

---

#### 2.3 Normal/Overdue â†’ Endï¼ˆå®Œæˆï¼‰

**è§¦å‘ä½ç½®**ï¼š`handlers/order_handlers.py::set_end()`

**æ›´æ–°é€»è¾‘**ï¼š

```python
# 1. æœ‰æ•ˆè®¢å•å‡å°‘
await update_all_stats('valid', -amount, -1, group_id)

# 2. å®Œæˆè®¢å•å¢åŠ 
await update_all_stats('completed', amount, 1, group_id)

# 3. æµåŠ¨èµ„é‡‘å¢åŠ 
await update_liquid_capital(amount)
```

**å½±å“çš„æ•°æ®**ï¼š
- âœ… `valid_orders` / `valid_amount`ï¼ˆå…¨å±€+åˆ†ç»„ï¼Œå‡å°‘ï¼‰
- âœ… `completed_orders` / `completed_amount`ï¼ˆå…¨å±€+åˆ†ç»„+æ—¥ç»“ï¼Œå¢åŠ ï¼‰
- âœ… `liquid_funds`ï¼ˆå…¨å±€ä½™é¢å¢åŠ ï¼‰
- âœ… `liquid_flow`ï¼ˆæ—¥ç»“æµé‡å¢åŠ ï¼‰

---

#### 2.4 Breach â†’ Breach Endï¼ˆè¿çº¦å®Œæˆï¼‰

**è§¦å‘ä½ç½®**ï¼š
- `handlers/order_handlers.py::set_breach_end()`
- `handlers/message_handlers.py::_handle_breach_end_amount()`

**æ›´æ–°é€»è¾‘**ï¼š

```python
# 1. è¿çº¦å®Œæˆè®¢å•å¢åŠ 
await update_all_stats('breach_end', amount, 1, group_id)

# 2. æµåŠ¨èµ„é‡‘å¢åŠ ï¼ˆè¿çº¦å®Œæˆé‡‘é¢ï¼‰
await update_liquid_capital(amount)
```

**å½±å“çš„æ•°æ®**ï¼š
- âœ… `breach_end_orders` / `breach_end_amount`ï¼ˆå…¨å±€+åˆ†ç»„+æ—¥ç»“ï¼Œå¢åŠ ï¼‰
- âœ… `liquid_funds`ï¼ˆå…¨å±€ä½™é¢å¢åŠ ï¼‰
- âœ… `liquid_flow`ï¼ˆæ—¥ç»“æµé‡å¢åŠ ï¼‰

**æ³¨æ„**ï¼š
- è¿çº¦è®¢å•æ•°é‡ä¸å˜ï¼ˆä»åœ¨ `breach_orders` ä¸­ï¼‰
- åªå¢åŠ è¿çº¦å®Œæˆé‡‘é¢å’Œæ•°é‡

---

### åœºæ™¯3: é‡‘é¢æ“ä½œ

#### 3.1 æœ¬é‡‘å‡å°‘ (`+<amount>b`)

**è§¦å‘ä½ç½®**ï¼š`handlers/amount_handlers.py::process_principal_reduction()`

**æ›´æ–°é€»è¾‘**ï¼š

```python
# 1. æœ‰æ•ˆé‡‘é¢å‡å°‘
await update_all_stats('valid', -amount, 0, group_id)

# 2. å®Œæˆé‡‘é¢å¢åŠ 
await update_all_stats('completed', amount, 0, group_id)

# 3. æµåŠ¨èµ„é‡‘å¢åŠ 
await update_liquid_capital(amount)
```

**å½±å“çš„æ•°æ®**ï¼š
- âœ… `valid_amount`ï¼ˆå…¨å±€+åˆ†ç»„ï¼Œå‡å°‘ï¼‰
- âœ… `completed_amount`ï¼ˆå…¨å±€+åˆ†ç»„+æ—¥ç»“ï¼Œå¢åŠ ï¼‰
- âœ… `liquid_funds`ï¼ˆå…¨å±€ä½™é¢å¢åŠ ï¼‰
- âœ… `liquid_flow`ï¼ˆæ—¥ç»“æµé‡å¢åŠ ï¼‰

**æ³¨æ„**ï¼š
- è®¢å•æ•°é‡ä¸å˜ï¼ˆè®¢å•ä»åœ¨ï¼Œåªæ˜¯é‡‘é¢å‡å°‘ï¼‰

---

#### 3.2 åˆ©æ¯æ”¶å…¥ (`+<amount>`)

**è§¦å‘ä½ç½®**ï¼š`handlers/amount_handlers.py::process_interest()`

**æ›´æ–°é€»è¾‘**ï¼š

```python
# 1. åˆ©æ¯æ”¶å…¥
await update_all_stats('interest', amount, 0, group_id)

# 2. æµåŠ¨èµ„é‡‘å¢åŠ 
await update_liquid_capital(amount)
```

**å½±å“çš„æ•°æ®**ï¼š
- âœ… `interest`ï¼ˆå…¨å±€+åˆ†ç»„+æ—¥ç»“ï¼Œå¢åŠ ï¼‰
- âœ… `liquid_funds`ï¼ˆå…¨å±€ä½™é¢å¢åŠ ï¼‰
- âœ… `liquid_flow`ï¼ˆæ—¥ç»“æµé‡å¢åŠ ï¼‰

**æ³¨æ„**ï¼š
- å¦‚æœæœ‰è®¢å•ï¼Œå…³è”åˆ°è®¢å•çš„å½’å±ID
- å¦‚æœæ²¡æœ‰è®¢å•ï¼Œæ›´æ–°å…¨å±€å’Œæ—¥ç»“æ•°æ®ï¼ˆ`group_id=None`ï¼‰

---

### åœºæ™¯4: å¼€é”€è®°å½•

**è§¦å‘ä½ç½®**ï¼š`handlers/message_handlers.py::_handle_expense_input()`

**æ›´æ–°é€»è¾‘**ï¼š

```python
# ç›´æ¥è°ƒç”¨æ•°æ®åº“å‡½æ•°
await db_operations.record_expense(date_str, expense_type, amount, note)
```

**å†…éƒ¨æ›´æ–°**ï¼ˆ`db_operations.py::record_expense()`ï¼‰ï¼š

```python
# 1. æ’å…¥è¯¦ç»†è®°å½•
INSERT INTO expense_records (date, type, amount, note)

# 2. æ›´æ–°æ—¥ç»“æ•°æ®
UPDATE daily_data SET company_expenses/other_expenses = ... + amount

# 3. æ›´æ–°å…¨å±€æµåŠ¨èµ„é‡‘ï¼ˆæ‰£é™¤å¼€é”€ï¼‰
UPDATE financial_data SET liquid_funds = liquid_funds - amount
```

**å½±å“çš„æ•°æ®**ï¼š
- âœ… `expense_records`ï¼ˆè¯¦ç»†è®°å½•ï¼‰
- âœ… `company_expenses` / `other_expenses`ï¼ˆæ—¥ç»“æ•°æ®ï¼Œå¢åŠ ï¼‰
- âœ… `liquid_funds`ï¼ˆå…¨å±€ä½™é¢ï¼Œå‡å°‘ï¼‰

**æ³¨æ„**ï¼š
- å¼€é”€ä¸æ›´æ–°åˆ°åˆ†ç»„æ•°æ®
- å¼€é”€ä¸æ›´æ–°åˆ°æ—¥ç»“çš„ `liquid_flow`ï¼ˆå› ä¸ºå·²ç»ç›´æ¥æ‰£é™¤ `liquid_funds`ï¼‰

---

### åœºæ™¯5: èµ„é‡‘è°ƒæ•´

**è§¦å‘ä½ç½®**ï¼š`handlers/command_handlers.py::adjust_funds()`

**æ›´æ–°é€»è¾‘**ï¼š

```python
# æ›´æ–°æµåŠ¨èµ„é‡‘ï¼ˆå¯ä»¥æ˜¯æ­£æ•°æˆ–è´Ÿæ•°ï¼‰
await update_liquid_capital(amount)
```

**å½±å“çš„æ•°æ®**ï¼š
- âœ… `liquid_funds`ï¼ˆå…¨å±€ä½™é¢ï¼Œå¢åŠ æˆ–å‡å°‘ï¼‰
- âœ… `liquid_flow`ï¼ˆæ—¥ç»“æµé‡ï¼Œå¢åŠ æˆ–å‡å°‘ï¼‰

**æ³¨æ„**ï¼š
- ç”¨äºæ‰‹åŠ¨è°ƒæ•´èµ„é‡‘ä½™é¢
- ä¸æ›´æ–°å…¶ä»–ç»Ÿè®¡æ•°æ®

---

### åœºæ™¯6: å½’å±å˜æ›´

**è§¦å‘ä½ç½®**ï¼š`handlers/attribution_handlers.py::change_orders_attribution()`

**æ›´æ–°é€»è¾‘**ï¼š

```python
# 1. ä»æ—§å½’å±å‡å°‘ç»Ÿè®¡æ•°æ®
for old_group_id, stats in old_group_stats.items():
    # å‡å°‘æœ‰æ•ˆè®¢å•
    await update_all_stats('valid', -amount, -count, old_group_id)
    # å‡å°‘è¿çº¦è®¢å•
    await update_all_stats('breach', -amount, -count, old_group_id)

# 2. åˆ°æ–°å½’å±å¢åŠ ç»Ÿè®¡æ•°æ®
await update_all_stats('valid', total_amount, total_count, new_group_id)
await update_all_stats('breach', total_amount, total_count, new_group_id)
```

**å½±å“çš„æ•°æ®**ï¼š
- âœ… `valid_orders` / `valid_amount`ï¼ˆæ—§å½’å±å‡å°‘ï¼Œæ–°å½’å±å¢åŠ ï¼‰
- âœ… `breach_orders` / `breach_amount`ï¼ˆæ—§å½’å±å‡å°‘ï¼Œæ–°å½’å±å¢åŠ ï¼‰
- âœ… åˆ†ç»„æ•°æ®ï¼ˆ`grouped_data`ï¼‰ç›¸åº”æ›´æ–°

**æ³¨æ„**ï¼š
- å·²å®Œæˆå’Œè¿çº¦å®Œæˆçš„è®¢å•ä¸è¿ç§»ç»Ÿè®¡æ•°æ®ï¼ˆå·²å›ºå®šï¼‰
- åªè¿ç§»æœ‰æ•ˆè®¢å•å’Œè¿çº¦è®¢å•çš„ç»Ÿè®¡

---

## ğŸ“‹ æ•°æ®æ›´æ–°è§„åˆ™æ€»ç»“

### å…¨å±€æ•°æ® (`financial_data`)

**æ›´æ–°æ—¶æœº**ï¼šæ‰€æœ‰ç»Ÿè®¡å˜æ›´éƒ½ä¼šæ›´æ–°

**å­—æ®µ**ï¼š
- `valid_orders`, `valid_amount` - æœ‰æ•ˆè®¢å•ï¼ˆå­˜é‡ï¼‰
- `breach_orders`, `breach_amount` - è¿çº¦è®¢å•
- `completed_orders`, `completed_amount` - å®Œæˆè®¢å•
- `breach_end_orders`, `breach_end_amount` - è¿çº¦å®Œæˆè®¢å•
- `new_clients`, `new_clients_amount` - æ–°å®¢æˆ·
- `old_clients`, `old_clients_amount` - è€å®¢æˆ·
- `interest` - åˆ©æ¯æ”¶å…¥
- `liquid_funds` - ç°é‡‘ä½™é¢

---

### åˆ†ç»„æ•°æ® (`grouped_data`)

**æ›´æ–°æ—¶æœº**ï¼šå½“æä¾›äº† `group_id` æ—¶æ›´æ–°

**å­—æ®µ**ï¼šä¸å…¨å±€æ•°æ®ç›¸åŒ

**æ³¨æ„**ï¼š
- å½’å±å˜æ›´æ—¶ä¼šè¿ç§»ç»Ÿè®¡æ•°æ®
- åˆ›å»ºå½’å±IDæ—¶ä¼šåˆå§‹åŒ–æ•°æ®

---

### æ—¥ç»“æ•°æ® (`daily_data`)

**æ›´æ–°æ—¶æœº**ï¼šåªæ›´æ–°æµé‡æ•°æ®ï¼ˆä¸åŒ…å«å­˜é‡ï¼‰

**å…è®¸çš„å­—æ®µ**ï¼ˆ`DAILY_ALLOWED_PREFIXES`ï¼‰ï¼š
- `new_clients`, `new_clients_amount`
- `old_clients`, `old_clients_amount`
- `interest`
- `completed_orders`, `completed_amount`
- `breach_orders`, `breach_amount`
- `breach_end_orders`, `breach_end_amount`
- `liquid_flow` - æµåŠ¨èµ„é‡‘æµé‡
- `company_expenses` - å…¬å¸å¼€é”€
- `other_expenses` - å…¶ä»–å¼€é”€

**ä¸æ›´æ–°çš„å­—æ®µ**ï¼š
- `valid_orders`, `valid_amount` - å­˜é‡æ•°æ®ï¼Œä¸åœ¨æ—¥ç»“è¡¨ä¸­

**åˆ†ç»„**ï¼š
- å…¨å±€æ—¥ç»“ï¼š`group_id = NULL`
- åˆ†ç»„æ—¥ç»“ï¼š`group_id = 'S01'` ç­‰

---

## ğŸ” æŠ¥è¡¨æ•°æ®æ¥æº

### å½“å‰çŠ¶æ€ï¼ˆæŠ¥è¡¨é¡¶éƒ¨ï¼‰

**æ•°æ®æ¥æº**ï¼š`financial_data` æˆ– `grouped_data`

**å­—æ®µ**ï¼š
- `valid_orders` - æœ‰æ•ˆè®¢å•æ•°
- `valid_amount` - æœ‰æ•ˆè®¢å•é‡‘é¢

---

### å‘¨æœŸæ•°æ®ï¼ˆæŠ¥è¡¨ä¸»ä½“ï¼‰

**æ•°æ®æ¥æº**ï¼š`daily_data`ï¼ˆé€šè¿‡ `get_stats_by_date_range()` èšåˆï¼‰

**å­—æ®µ**ï¼š
- `liquid_flow` - æµåŠ¨èµ„é‡‘
- `new_clients`, `new_clients_amount` - æ–°å®¢æˆ·
- `old_clients`, `old_clients_amount` - è€å®¢æˆ·
- `interest` - åˆ©æ¯æ”¶å…¥
- `completed_orders`, `completed_amount` - å®Œæˆè®¢å•
- `breach_orders`, `breach_amount` - è¿çº¦è®¢å•
- `breach_end_orders`, `breach_end_amount` - è¿çº¦å®Œæˆ
- `company_expenses` - å…¬å¸å¼€é”€
- `other_expenses` - å…¶ä»–å¼€é”€

---

### è´¦æˆ·ä½™é¢ï¼ˆæŠ¥è¡¨åº•éƒ¨ï¼‰

**æ•°æ®æ¥æº**ï¼š`financial_data.liquid_funds`

**è¯´æ˜**ï¼šå½“å‰ç°é‡‘ä½™é¢

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å­˜é‡ vs æµé‡**ï¼š
   - `valid` æ˜¯å­˜é‡æ•°æ®ï¼Œä¸æ›´æ–°åˆ°æ—¥ç»“è¡¨
   - å…¶ä»–å­—æ®µæ˜¯æµé‡æ•°æ®ï¼Œä¼šæ›´æ–°åˆ°æ—¥ç»“è¡¨

2. **å½’å±å˜æ›´**ï¼š
   - å·²å®Œæˆè®¢å•ä¸è¿ç§»ç»Ÿè®¡æ•°æ®
   - åªè¿ç§»æœ‰æ•ˆè®¢å•å’Œè¿çº¦è®¢å•

3. **å†å²è®¢å•**ï¼š
   - ä¸æ‰£é™¤æµåŠ¨èµ„é‡‘
   - ä¸æ›´æ–°å®¢æˆ·ç»Ÿè®¡
   - ä¸è‡ªåŠ¨æ’­æŠ¥

4. **å¼€é”€è®°å½•**ï¼š
   - ç›´æ¥æ‰£é™¤ `liquid_funds`
   - ä¸æ›´æ–° `liquid_flow`ï¼ˆå› ä¸ºå·²ç»ç›´æ¥æ‰£é™¤ä½™é¢ï¼‰

5. **èµ„é‡‘è°ƒæ•´**ï¼š
   - åŒæ—¶æ›´æ–° `liquid_funds` å’Œ `liquid_flow`
   - ç”¨äºæ‰‹åŠ¨è°ƒæ•´ä½™é¢

---

## ğŸ“Š æ•°æ®æµå›¾

```
è®¢å•åˆ›å»º
  â”œâ”€â†’ valid/breach (å…¨å±€+åˆ†ç»„)
  â”œâ”€â†’ liquid_funds â†“ (éå†å²)
  â”œâ”€â†’ liquid_flow â†“ (éå†å²)
  â””â”€â†’ new_clients/old_clients (å…¨å±€+åˆ†ç»„+æ—¥ç»“ï¼Œéå†å²)

çŠ¶æ€å˜æ›´
  â”œâ”€â†’ Normal/Overdue â†” Breach: valid â†” breach
  â”œâ”€â†’ â†’ End: valid â†“, completed â†‘, liquid_funds â†‘
  â””â”€â†’ Breach â†’ Breach End: breach_end â†‘, liquid_funds â†‘

é‡‘é¢æ“ä½œ
  â”œâ”€â†’ æœ¬é‡‘å‡å°‘: valid â†“, completed â†‘, liquid_funds â†‘
  â””â”€â†’ åˆ©æ¯æ”¶å…¥: interest â†‘, liquid_funds â†‘

å¼€é”€è®°å½•
  â”œâ”€â†’ expense_records (è¯¦ç»†è®°å½•)
  â”œâ”€â†’ company_expenses/other_expenses â†‘ (æ—¥ç»“)
  â””â”€â†’ liquid_funds â†“ (å…¨å±€)

èµ„é‡‘è°ƒæ•´
  â””â”€â†’ liquid_funds Â±, liquid_flow Â±

å½’å±å˜æ›´
  â””â”€â†’ valid/breach (æ—§å½’å± â†“, æ–°å½’å± â†‘)
```

---

## ğŸ”§ ç»´æŠ¤å»ºè®®

1. **ç»Ÿä¸€ä½¿ç”¨ `update_all_stats()`**ï¼šç¡®ä¿æ•°æ®ä¸€è‡´æ€§
2. **æ£€æŸ¥å­—æ®µæ˜ å°„**ï¼šç¡®ä¿å­—æ®µåæ­£ç¡®
3. **éªŒè¯æ—¥ç»“å­—æ®µ**ï¼šåªæ›´æ–°å…è®¸çš„å­—æ®µ
4. **æµ‹è¯•å½’å±å˜æ›´**ï¼šç¡®ä¿ç»Ÿè®¡æ•°æ®æ­£ç¡®è¿ç§»
5. **ç›‘æ§èµ„é‡‘æµ**ï¼šç¡®ä¿ `liquid_funds` å’Œ `liquid_flow` åŒæ­¥

